{% extends "base.html" %}

{% block title %}Login - NIDS{% endblock %}

{% block content %}
<div class="login-split">
    <!-- Left: Animation Section -->
    <div class="login-left">
        <canvas id="network-canvas" class="network-canvas"></canvas>
        <div class="login-hero">
            <div class="logo-glow">
                <img src="{{ url_for('static', filename='images/images.jpg') }}" alt="NIDS Logo" class="logo-img">
            </div>
            <h1 class="tagline">Real-time Network Threat Detection</h1>
            <ul class="features-list">
                <li><span class="icon">üõ°Ô∏è</span> ML-Powered Detection</li>
                <li><span class="icon">üìä</span> Analytics Dashboard</li>
                <li><span class="icon">ÔøΩ</span> Performance Metrics</li>
                <li><span class="icon">üîí</span> Secure User Management</li>
            </ul>
        </div>
    </div>
    <!-- Right: Auth Card -->
    <div class="login-right">
        <div class="auth-card glassmorphic">
            <div class="tab-toggle">
                <button id="login-tab" class="active">Login</button>
                <button id="register-tab">Register</button>
            </div>
            <form id="login-form" class="auth-form" method="post" action="/login">
                <div class="form-group floating-label">
                    <input type="text" name="username" id="login-username" required placeholder="Enter your username">
                    <label for="login-username">Username</label>
                </div>
                <div class="form-group floating-label">
                    <input type="password" name="password" id="login-password" required placeholder="Enter your password">
                    <label for="login-password">Password</label>
                </div>
                <div class="form-options">
                    <label class="custom-checkbox">
                        <input type="checkbox" name="remember">
                        <span class="checkmark"></span>
                        Remember me
                    </label>
                    <a href="#" class="forgot-link">Forgot password?</a>
                </div>
                <button type="submit" class="btn-primary animated-btn">Sign In</button>
            </form>
            <form id="register-form" class="auth-form" method="post" action="/register" style="display:none;">
                <div class="form-group floating-label">
                    <input type="text" name="username" id="register-username" required placeholder="Choose a username">
                    <label for="register-username">Username</label>
                </div>
                <div class="form-group floating-label">
                    <input type="password" name="password" id="register-password" required placeholder="Create a password">
                    <label for="register-password">Password</label>
                    <div id="password-strength"></div>
                </div>
                <div class="form-group floating-label">
                    <input type="password" name="confirm_password" id="register-confirm" required placeholder="Confirm your password">
                    <label for="register-confirm">Confirm Password</label>
                </div>
                <button type="submit" class="btn-primary animated-btn">Register</button>
            </form>
            <div class="social-login">
                <!-- Optional: Social login buttons -->
            </div>
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='login.js') }}"></script>
<script src="{{ url_for('static', filename='network.js') }}"></script>
<script>
    // Tab toggle logic
    document.getElementById('login-tab').onclick = function() {
        this.classList.add('active');
        document.getElementById('register-tab').classList.remove('active');
        document.getElementById('login-form').style.display = '';
        document.getElementById('register-form').style.display = 'none';
    };
    document.getElementById('register-tab').onclick = function() {
        this.classList.add('active');
        document.getElementById('login-tab').classList.remove('active');
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('register-form').style.display = '';
    };

    // Activate register tab if register=True from Flask
    var registerActive = "{{ 'true' if register else 'false' }}";
    window.onload = function() {
        if (registerActive === "true") {
            document.getElementById('register-tab').click();
        }
    };
</script>
<style>
/* Hide sidebar for login page */
.sidebar { display: none !important; }
.main-content { margin-left: 0 !important; padding: 0 !important; }
body.login-bg { background: #0f172a; }
.login-split {
    display: flex;
    min-height: 100vh;
}
.login-left {
    flex: 1;
    background: linear-gradient(135deg, #1e293b 60%, #334155 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    position: relative;
    overflow: hidden;
}
.network-canvas {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 1;
    display: block;
}
.login-hero {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2;
    text-align: center;
    width: 100%;
    pointer-events: none;
}
.login-hero * {
    pointer-events: auto;
}
.logo-glow {
    margin-bottom: 1.5em;
}
.logo-img {
    width: 80px;
    border-radius: 50%;
    box-shadow: 0 0 30px 10px #38bdf8;
    background: #fff;
}
.tagline {
    font-size: 1.5em;
    margin-bottom: 1em;
}
.features-list {
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: 1.1em;
}
.features-list li {
    margin-bottom: 0.5em;
}
.icon {
    margin-right: 0.5em;
}
.login-right {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8fafc;
}
.auth-card {
    background: rgba(255,255,255,0.9);
    border-radius: 16px;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    padding: 2em 2.5em;
    width: 100%;
    max-width: 400px;
}
.tab-toggle {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1.5em;
}
.tab-toggle button {
    flex: 1;
    padding: 0.75em 0;
    border: none;
    background: #e0e7ef;
    color: #1e293b;
    font-weight: bold;
    cursor: pointer;
    border-radius: 8px 8px 0 0;
    transition: background 0.2s;
}
.tab-toggle button.active {
    background: #38bdf8;
    color: #fff;
}
.auth-form {
    display: flex;
    flex-direction: column;
}
.form-group {
    margin-bottom: 1.2em;
    position: relative;
}
.floating-label input {
    width: 100%;
    padding: 1em 0.5em 0.5em 0.5em;
    border: 1px solid #cbd5e1;
    border-radius: 8px;
    background: #f1f5f9;
    outline: none;
    font-size: 1em;
}
.floating-label label {
    position: absolute;
    left: 0.75em;
    top: 1.1em;
    color: #64748b;
    font-size: 0.95em;
    pointer-events: none;
    transition: 0.2s;
}
.floating-label input:focus + label,
.floating-label input:not(:placeholder-shown) + label {
    top: -0.7em;
    left: 0.5em;
    font-size: 0.8em;
    color: #38bdf8;
    background: #f8fafc;
    padding: 0 0.25em;
}
.btn-primary {
    background: #38bdf8;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.9em 0;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    margin-top: 0.5em;
    transition: background 0.2s;
}
.btn-primary:hover, .animated-btn:active {
    background: #0ea5e9;
}
.form-options {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1em;
}
.custom-checkbox {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-size: 0.95em;
}
.custom-checkbox input[type="checkbox"] {
    margin-right: 0.5em;
}
.forgot-link {
    color: #38bdf8;
    text-decoration: none;
    font-size: 0.95em;
}
.forgot-link:hover {
    text-decoration: underline;
}
.flash-messages {
    margin-bottom: 1em;
}
.alert {
    padding: 0.75em 1em;
    border-radius: 6px;
    margin-bottom: 0.5em;
    font-size: 1em;
}
.alert-danger {
    background: #fee2e2;
    color: #b91c1c;
}
.alert-success {
    background: #dcfce7;
    color: #166534;
}
.alert-info {
    background: #e0f2fe;
    color: #0369a1;
}

/* --- Mobile Responsiveness for Login Page (768px and below) --- */
@media (max-width: 768px) {
    .login-split {
        flex-direction: column; /* Stack columns vertically */
    }

    .login-left {
        display: none; /* Hide the background animation/marketing section on small screens */
    }

    .login-right {
        flex: none;
        width: 100%;
        padding: 2rem 1rem; /* Add padding to prevent the card from touching edges */
    }

    .auth-card {
        max-width: 100%;
        margin: 0;
        box-shadow: none; /* Less aggressive shadow on full-width mobile card */
    }
}
</style>
{% endblock %}
